<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.goodwill.dao.SetDao">
	<select id="GetSetList" resultType="com.goodwill.domain.Set">
		SELECT * FROM SETS WHERE (DS_CODE=#{keyword} or DS_NAME like CONCAT('%', #{keyword}, '%'))
		AND DATA_SET_TYPE = 0 AND STUDY_TYPE = #{study} LIMIT #{limit} OFFSET #{offset}
	</select>
	<select id="CountSetList" resultType="Integer">
		SELECT COUNT(*) FROM SETS WHERE (DS_CODE=#{keyword} or DS_NAME like CONCAT('%', #{keyword}, '%'))
		AND DATA_SET_TYPE = 0 AND STUDY_TYPE = #{study}
	</select>	
	<select id="GetGroupListBySetID" resultType="com.goodwill.domain.Set">
		SELECT * FROM SETS LEFT JOIN SET_VS_ELEMENT ON CID = SETS.ID 
		WHERE (SETS.DS_CODE=#{keyword} or DS_NAME like CONCAT('%', #{keyword}, '%')) 
		AND FID = #{datasetID} AND CTYPE =1 LIMIT #{limit} OFFSET #{offset}
	</select>
	<select id="CountGroupListBySetID" resultType="Integer">
		SELECT COUNT(*) FROM SETS LEFT JOIN SET_VS_ELEMENT ON CID = SETS.ID 
		WHERE (SETS.DS_CODE=#{keyword} or DS_NAME like CONCAT('%', #{keyword}, '%')) 
		AND FID = #{datasetID} AND CTYPE =1
	</select>
	<insert id="AddSet" parameterType="Set">
        INSERT INTO SETS(
          `DS_CODE`, `DS_NAME`, `PYM`, `WBM`, `CREATOR`, `CREATED_AT`, `UPDATED_AT`, `DS_GROUP`, `YEAR_VERSION`, `DIS_GROUP`, `DATA_SET_TYPE`, `STUDY_TYPE`, `STANDARD`
        ) VALUES (
          #{DS_CODE},#{DS_NAME},#{PYM},#{WBM},#{CREATOR},
          #{CREATED_AT},#{UPDATED_AT},#{DS_GROUP},#{YEAR_VERSION},#{DIS_GROUP},
          #{DATA_SET_TYPE},#{STUDY_TYPE},#{STANDARD}
        )
    </insert>	
</mapper>