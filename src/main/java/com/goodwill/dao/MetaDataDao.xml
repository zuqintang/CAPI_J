<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.goodwill.dao.MetaDataDao">
	<select id="GetElementListBySetID" resultType="com.goodwill.domain.Element">
		SELECT * FROM ELEMENTS LEFT JOIN SET_VS_ELEMENT ON CID = ELEMENTS.ID 
		WHERE (ELEMENTS.METADATA_IDENTIFY=#{keyword} or ELEMENTS.METADATA_NAME like CONCAT('%', #{keyword}, '%')) 
		AND FID = #{datasetID} AND CTYPE =2 LIMIT #{limit} OFFSET #{offset}
	</select>
	<select id="CountElementListBySetID" resultType="Integer">
		SELECT COUNT(*) FROM ELEMENTS LEFT JOIN SET_VS_ELEMENT ON CID = ELEMENTS.ID 
		WHERE (ELEMENTS.METADATA_IDENTIFY=#{keyword} or ELEMENTS.METADATA_NAME like CONCAT('%', #{keyword}, '%')) 
		AND FID = #{datasetID} AND CTYPE =2
	</select>	
	<select id="SumMetaDataByStandards" resultType="com.goodwill.domain.SumResult">
		SELECT STANDARD AS FLAG ,COUNT(METADATA_IDENTIFY) AS TOTAL
			   FROM ELEMENTS
			   GROUP BY STANDARD
	</select>
	<select id="SumMetaDataByStatus" resultType="com.goodwill.domain.SumResult">	
		SELECT STATUS AS FLAG ,COUNT(METADATA_IDENTIFY) AS TOTAL
			   FROM ELEMENTS
	           GROUP BY `STATUS`
	</select>
	<select id="GetMetaList" resultType="com.goodwill.domain.Element" parameterType="java.util.Map">
		SELECT * FROM ELEMENTS WHERE (METADATA_IDENTIFY=#{query} or METADATA_NAME like
		CONCAT('%', #{query}, '%'))		
		ORDER BY CREATE_DATE DESC LIMIT #{limit} OFFSET #{offset}
	</select>
	<select id="CountMetaList" resultType="Integer" parameterType="java.util.Map">
		SELECT COUNT(*) FROM ELEMENTS WHERE METADATA_IDENTIFY=#{query} or METADATA_NAME like
		CONCAT('%', #{query}, '%')
	</select>
</mapper>